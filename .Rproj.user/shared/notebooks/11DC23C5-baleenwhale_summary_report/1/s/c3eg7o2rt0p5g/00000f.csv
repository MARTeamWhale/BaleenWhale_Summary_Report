"2","r error 4 (Error in eval(ele) : object 'params' not found
)"
"0","effort.presence <- rec.days %>% "
"0","  filter(station %in% species.data$station) %>%"
"0","  left_join(species.data, by = c('station', 'rec_days' = 'detecdate')) %>% "
"0","  select(station,rec_days,species,callcat, presence) %>%"
"0","  distinct() %>% "
"0","  complete(station, rec_days, species = params$species) %>%"
"0","  replace_na(list(presence = ""N"")) %>% "
"0","  "
"0","  mutate(month = month(rec_days),"
"0","         season= case_when((month == 3|month == 4| month==5) ~ 'SPRING',"
"0","                           (month == 6|month == 7|month == 8) ~ 'SUMMER',"
"0","                           (month == 9|month == 10|month == 11)~ 'FALL',"
"0","                           (month == 12|month == 1|month == 2) ~ 'WINTER'))"
"0",""
"0","effort.table <- data.frame(site = unique(effort.presence$station)) %>% "
"0","  "
"0","  #add number of recording days"
"0","  left_join(rec.days %>% "
"0","              select(station,rec_days) %>% "
"0","              group_by(station) %>% "
"0","              summarize(n.rec.days = dplyr::n()), by = join_by(site==station)) %>%"
"0","   "
"0","  #add number of days with species"
"0","  left_join(effort.presence %>%"
"0","              group_by(station,callcat) %>% "
"0","              summarise(presence=sum(presence==""D"")),by = join_by(site==station)) %>%"
"0","  drop_na() %>% "
"0","  mutate(perc = round((presence/n.rec.days)*100,1)) %>% "
"0","              pivot_wider(names_from = ""callcat"",values_from = c(""presence"",""perc"")) %>%"
"0","   "
"0","  #add # of days with calls per season"
"0","  left_join(effort.presence %>%"
"0","              group_by(station,season, callcat) %>%"
"0","              summarise(presence= sum(presence==""D"")),by = join_by(site==station)) %>%"
"0","  drop_na() %>% "
"0","  mutate(perc = round((presence/n.rec.days)*100,1)) %>% "
"0","              pivot_wider(names_from = c(""season"",""callcat""),values_from = c(""presence"",""perc"")) %>%"
"0","  replace(is.na(.),0) %>% "
"0","   "
"0","  # add # recording days per season"
"0","  left_join(rec.days %>% "
"0","              select(station, rec_days,season) %>% "
"0","              group_by(station,season) %>% "
"0","              summarize(n.rec.days = dplyr::n()) %>% "
"0","              pivot_wider(names_from = ""season"",values_from = ""n.rec.days""),by = join_by(site==station)) %>% "
"0","  #clean up"
"0","  arrange(factor(site, levels = Station.Order))"
"0",""
"0","results.table <- effort.table %>%"
"0","   pivot_longer("
"0","    cols = starts_with(""presence"") | starts_with(""perc""),"
"0","    names_to = c("".value"", ""season"", ""callcat""),"
"0","    names_pattern = ""(presence|perc)_?(FALL|SPRING|SUMMER|WINTER)?_?(.*)"") %>%"
"0","  mutate(season = sub(""^$"", ""ALL"", season))"
"0",""
"0","#  rename(`Winter(Dec-Feb)` = WINTER, `Spring (Mar-May)` = SPRING, `Summer (Jun-Aug)`= SUMMER,`Fall (Sep-Nov)`= FALL)"
"0","  "
