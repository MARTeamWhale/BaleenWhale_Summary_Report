"2","r error 4 (Error in eval(ele) : object 'params' not found
)"
"0","species.month.graph <- species.data %>% "
"0","  mutate(daysinmonth = days_in_month(detecdate),"
"0","         year = year(detecdate),"
"0","         month = month(detecdate, label=TRUE, abbr=TRUE),"
"0","         month_num = month(detecdate),"
"0","         valcode = 1) %>% "
"0","  group_by(year,month,month_num,station, species, callcat, spcallgroup,spcallgroup_label,daysinmonth) %>% "
"0","  summarise(daysofmonth = sum(valcode)) %>% "
"0","  ungroup() %>% "
"0","   group_by(station,month,month_num,species, callcat, spcallgroup,spcallgroup_label, daysinmonth) %>% "
"0","  summarise(mean = mean(daysofmonth),"
"0","            n= n(),"
"0","            sd= sd(daysofmonth),"
"0","            se = sd(daysofmonth)/sqrt(n())) %>% "
"0","  mutate(percofmonth = (mean / daysinmonth) * 100,"
"0","         error = (se/daysinmonth)*100) %>% "
"0","  ungroup() %>% "
"0","  left_join(data.frame(colour=cols, spcallgroup= names(cols)), by=""spcallgroup"")"
"0",""
"0","# Graph that ----"
"0",""
"0","generate_plot_month <- function(data, value){"
"0","ggplot() +"
"0","  "
"0","  facet_wrap(~fct_relevel(station, rev(Station.Order)), ncol=1, strip.position=""left"")+"
"0","  "
"0","  # plot percentage of days per month collectively"
"0","  "
"0","  geom_bar(data=data, aes(x=month, y=percofmonth, fill =str_wrap(spcallgroup_label)), stat=""identity"")+"
"0","  scale_fill_manual(values = data$colour, labels = str_wrap(data$spcallgroup_label), name = """")+"
"0","  scale_y_continuous(limits = c(0, 100), breaks = c(0,25,50,75,100))+"
"0","  "
"0","  #add error bars"
"0","  geom_errorbar(data=data, aes(x=month, ymin=percofmonth-error, ymax=percofmonth+error), width=.1, colour= darken_color(data$colour))+"
"0","  "
"0","  # add labels"
"0","  labs(x = ""Month"", y = ""% Days"")+"
"0"," "
"0","  # format plot "
"0","  theme(panel.grid.minor = element_blank(), "
"0","        panel.grid.major.y= element_blank(), "
"0","        panel.grid.major.x = element_blank(), # use element_line(size = 0.5, colour = ""grey"") to see grid lines"
"0","        panel.background = element_rect(fill= ""white"", colour = ""grey50""), # format gridlines and background"
"0","        axis.text = element_text(size = 12), # format x axis font "
"0","        axis.title = element_text(size = 14, face = ""bold""),"
"0","        strip.text.x = element_text(size = 12,face = ""bold""), # format facet heading/ year text "
"0","        strip.background =element_rect(fill=""white"", colour = ""black""), # format facet strip background and border"
"0","        panel.border = element_rect(fill = NA, colour = ""black""),"
"0","        plot.margin = margin(1,0,0,1,""cm""))+ # format plot border"
"0","  guides(fill = ""none"")"
"0","}"
"0",""
"0","plot_list <-list()"
"0",""
"0","unique_values <- unique(species.month.graph$spcallgroup)"
"0",""
"0","for (value in unique_values) {"
"0","  subset_data_month <- filter(species.month.graph, spcallgroup == value)"
"0","  plot <- generate_plot_month(subset_data_month, value)"
"0","  plot_list[[as.character(value)]] <- plot"
"0","}"
"0",""
"0","# Function to generate the text for captions"
"0","generate_caption <- function(value) {"
"0","  species_label <- unique(subset(species.month.graph, spcallgroup == value)$spcallgroup_label)"
"0","  paste0("
"0","    ""Percentage of recording days with confirmed "", species_label, "" present for each month at each station. In cases where multiple years of data were collected the average percentage of days/month with "", species_label,"" present were calculated (error bars = standard error)."")"
"0","}"
"0",""
"0","for (value in unique_values) {"
"0","  print(plot_list[[as.character(value)]])"
"0","  "
"0","month.text <- generate_caption(value)"
"0",""
"0","fig_counter <- fig_counter+1"
"0",""
"0","cat(paste0(""\n\n"",""**Figure "", fig_counter, "".** "", month.text, ""\n\n""))"
"0","}"
"1","

**Figure 3.** Percentage of recording days with confirmed Humpback whale (all calls) present for each month at each station. In cases where multiple years of data were collected the average percentage of days/month with Humpback whale (all calls) present were calculated (error bars = standard error).

"
