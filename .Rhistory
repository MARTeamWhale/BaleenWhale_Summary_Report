csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
data.input <- do.call(rbind, dfs)
species.data <- data.input %>%
filter(presence == "D") %>%   # filters for definite presence
filter(year(detecdate)>=params$year_start& year(detecdate)<=params$year_end) %>%
filter(if (params$filterspecies) species %in% params$species else TRUE) %>%   # filters for species of %>% # filters for species of interest
select(!calltype) %>%
mutate(callcat = case_when(callcat == "NS"~"MO",
callcat == "SG"~"MO", .default =callcat)) %>%
filter(callcat %in% call.cats) %>%  #filters for wanted call category
distinct() %>%
mutate(spcallgroup_label = case_when((species== "Bm" & callcat == "IF")~"Blue whale (tonal calls)",
(species== "Bm" & callcat == "A")~"Blue whale (audible calls)",
(species== "Bp" & callcat == "IS")~"Fin whale (20Hz calls)",
(species== "Bb" & callcat == "FF")~"Sei whale (full frequency downsweep calls)",
(species== "Mn")                  ~"Humpback whale (all calls)",
(species== "Eg" & callcat == "UP")~"North Atlantic right whale (upcalls)",
(species== "Ba" & callcat == "P")~"Minke whale (pulse trains)")) %>%
mutate(spcallgroup = case_when(species=='Bm' & callcat=="IF" ~ 'BW_IF_all',
species=="Bm" & callcat=='A' ~ 'BW_A_all',
species=='Bp' & callcat=='IS' ~ 'FW_IS_D',
species=='Bb' & callcat=='FF' ~ 'SW_FF_all',
species=='Mn' ~ 'HB_all',
species=='Eg' & callcat=='UP'~ 'RW_UP_U',
species=="Ba"~ 'MW_all'))
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
View(dfs)
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
if (params$interim_data){
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
deployment = 'GMB_2022_10'
if (params$interim_data){
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE)
subfolder
subfolder = "R:\\Science\\CetaceanOPPNoise\\CetaceanOPPNoise_5\\BaleenWhale_AcousticAnalysis\\Deployments/GMB_2022_10"
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = paste0(deployment, "_dailypresence.csv"), #find the presence csv
full.names = TRUE)
csv_file <- list.files(paste0(subfolders,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
# List all subfolders
subfolders <- list.files(main_folder, full.names = TRUE) #list all subfolders (aka Validation, Results)
if (params$filterstations){
subfolders <- subfolders %>% grep(paste(params$stations, collapse = "|"),., value = TRUE)
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
View(dfs)
data.input <- do.call(rbind, dfs)
data.input <- bind_rows(dfs)
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate)) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
subfolder
subfolder = "R:\\Science\\CetaceanOPPNoise\\CetaceanOPPNoise_5\\BaleenWhale_AcousticAnalysis\\Deployments/GMB_2022_10"
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
data.input <- bind_rows(dfs)
View(data.input)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
# load packages
library(pacman)
p_load(purrr, readxl,lubridate,tidyverse,here,ggnewscale,gridExtra,dbscan,sf,
mapdata, marmap, ggspatial, ggpattern, ggrepel, maps, kableExtra, tinytex,
flextable, RColorBrewer,xlsx,crul,stringr,readr,ftExtra, cowplot)
# set dplyr not to display 'summarise' messages
options(dplyr.summarise.inform = FALSE)
fig_counter <- 0
tab_counter <- 0
## Whale Presence Input  ----
call.cats <- c("IS","A","IF","FF","MO","UP","PT")
# Set the path to your main folder
main_folder <- r"(R:\Science\CetaceanOPPNoise\CetaceanOPPNoise_5\BaleenWhale_AcousticAnalysis\Deployments)" # direct to all deployments
# List all subfolders
subfolders <- list.files(main_folder, full.names = TRUE) #list all subfolders (aka Validation, Results)
if (params$filterstations){
subfolders <- subfolders %>% grep(paste(params$stations, collapse = "|"),., value = TRUE)
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
# load packages
library(pacman)
p_load(purrr, readxl,lubridate,tidyverse,here,ggnewscale,gridExtra,dbscan,sf,
mapdata, marmap, ggspatial, ggpattern, ggrepel, maps, kableExtra, tinytex,
flextable, RColorBrewer,xlsx,crul,stringr,readr,ftExtra, cowplot)
# set dplyr not to display 'summarise' messages
options(dplyr.summarise.inform = FALSE)
fig_counter <- 0
tab_counter <- 0
## Whale Presence Input  ----
call.cats <- c("IS","A","IF","FF","MO","UP","PT")
# Set the path to your main folder
main_folder <- r"(R:\Science\CetaceanOPPNoise\CetaceanOPPNoise_5\BaleenWhale_AcousticAnalysis\Deployments)" # direct to all deployments
# List all subfolders
subfolders <- list.files(main_folder, full.names = TRUE) #list all subfolders (aka Validation, Results)
if (params$filterstations){
subfolders <- subfolders %>% grep(paste(params$stations, collapse = "|"),., value = TRUE)
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
# load packages
library(pacman)
p_load(purrr, readxl,lubridate,tidyverse,here,ggnewscale,gridExtra,dbscan,sf,
mapdata, marmap, ggspatial, ggpattern, ggrepel, maps, kableExtra, tinytex,
flextable, RColorBrewer,xlsx,crul,stringr,readr,ftExtra, cowplot)
# set dplyr not to display 'summarise' messages
options(dplyr.summarise.inform = FALSE)
fig_counter <- 0
tab_counter <- 0
## Whale Presence Input  ----
call.cats <- c("IS","A","IF","FF","MO","UP","PT")
# Set the path to your main folder
main_folder <- r"(R:\Science\CetaceanOPPNoise\CetaceanOPPNoise_5\BaleenWhale_AcousticAnalysis\Deployments)" # direct to all deployments
# List all subfolders
subfolders <- list.files(main_folder, full.names = TRUE) #list all subfolders (aka Validation, Results)
if (params$filterstations){
subfolders <- subfolders %>% grep(paste(params$stations, collapse = "|"),., value = TRUE)
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
if (nrow(df) == 0) {
next
}
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
# Initialize an empty list to store dataframes
dfs <- list()
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
# load packages
library(pacman)
p_load(purrr, readxl,lubridate,tidyverse,here,ggnewscale,gridExtra,dbscan,sf,
mapdata, marmap, ggspatial, ggpattern, ggrepel, maps, kableExtra, tinytex,
flextable, RColorBrewer,xlsx,crul,stringr,readr,ftExtra, cowplot)
# set dplyr not to display 'summarise' messages
options(dplyr.summarise.inform = FALSE)
fig_counter <- 0
tab_counter <- 0
## Whale Presence Input  ----
call.cats <- c("IS","A","IF","FF","MO","UP","PT")
# Set the path to your main folder
main_folder <- r"(R:\Science\CetaceanOPPNoise\CetaceanOPPNoise_5\BaleenWhale_AcousticAnalysis\Deployments)" # direct to all deployments
# List all subfolders
subfolders <- list.files(main_folder, full.names = TRUE) #list all subfolders (aka Validation, Results)
if (params$filterstations){
subfolders <- subfolders %>% grep(paste(params$stations, collapse = "|"),., value = TRUE)
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
if (length(csv_file) == 0) next
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
data.input <- bind_rows(dfs)
species.data <- data.input %>%
filter(presence == "D") %>%   # filters for definite presence
filter(year(detecdate)>=params$year_start& year(detecdate)<=params$year_end) %>%
filter(if (params$filterspecies) species %in% params$species else TRUE) %>%   # filters for species of %>% # filters for species of interest
select(!calltype) %>%
mutate(callcat = case_when(callcat == "NS"~"MO",
callcat == "SG"~"MO", .default =callcat)) %>%
filter(callcat %in% call.cats) %>%  #filters for wanted call category
distinct() %>%
mutate(spcallgroup_label = case_when((species== "Bm" & callcat == "IF")~"Blue whale (tonal calls)",
(species== "Bm" & callcat == "A")~"Blue whale (audible calls)",
(species== "Bp" & callcat == "IS")~"Fin whale (20Hz calls)",
(species== "Bb" & callcat == "FF")~"Sei whale (full frequency downsweep calls)",
(species== "Mn")                  ~"Humpback whale (all calls)",
(species== "Eg" & callcat == "UP")~"North Atlantic right whale (upcalls)",
(species== "Ba" & callcat == "P")~"Minke whale (pulse trains)")) %>%
mutate(spcallgroup = case_when(species=='Bm' & callcat=="IF" ~ 'BW_IF_all',
species=="Bm" & callcat=='A' ~ 'BW_A_all',
species=='Bp' & callcat=='IS' ~ 'FW_IS_D',
species=='Bb' & callcat=='FF' ~ 'SW_FF_all',
species=='Mn' ~ 'HB_all',
species=='Eg' & callcat=='UP'~ 'RW_UP_U',
species=="Ba"~ 'MW_all'))
## All the labelling bits and pieces ----
species.call.label <- unique(species.data$spcallgroup_label[species.data$species==params$species])
spcallgroup_labels = c("Blue whale (tonal calls)","Blue whale (audible calls)","Fin whale (20Hz calls)",
"Sei whale (full frequency downsweep calls)","Humpback whale (all calls)",
"North Atlantic right whale (upcalls)","Minke whale (pulse trains)")
spcallgroup_list <- c('BW_IF_all','BW_A_all',"FW_IS_D","SW_FF_all","HB_all", "RW_UP_U", "MW_all")
sp_label <-c("Blue whale (tonal calls)","Blue whale (audible calls)","Fin whale","Sei whale","Humpback whale", "North Atlantic right whale", "Minke whale")
names(spcallgroup_list) <-sp_label
cols <-c( "#1F78B4","#A6CEE3","#7570B3", "#F0E442", "#E7298A", "#D55E00", "#66A61E")
names(cols) <- spcallgroup_list
fig_height <- as.numeric(length(unique(species.data$station)))
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
# load packages
library(pacman)
p_load(purrr, readxl,lubridate,tidyverse,here,ggnewscale,gridExtra,dbscan,sf,
mapdata, marmap, ggspatial, ggpattern, ggrepel, maps, kableExtra, tinytex,
flextable, RColorBrewer,xlsx,crul,stringr,readr,ftExtra, cowplot)
# set dplyr not to display 'summarise' messages
options(dplyr.summarise.inform = FALSE)
fig_counter <- 0
tab_counter <- 0
## Whale Presence Input  ----
call.cats <- c("IS","A","IF","FF","MO","UP","PT")
# Set the path to your main folder
main_folder <- r"(R:\Science\CetaceanOPPNoise\CetaceanOPPNoise_5\BaleenWhale_AcousticAnalysis\Deployments)" # direct to all deployments
# List all subfolders
subfolders <- list.files(main_folder, full.names = TRUE) #list all subfolders (aka Validation, Results)
if (params$filterstations){
subfolders <- subfolders %>% grep(paste(params$stations, collapse = "|"),., value = TRUE)
}
# Initialize an empty list to store dataframes
dfs <- list()
# Iterate over each subfolder, read the CSV files, and combine into a single dataframe
for (subfolder in subfolders) {
# Extract fruit name from the subfolder name
deployment <- basename(subfolder) #extract deployment name
# Read the CSV file
if (params$interim_data){
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE)
} else {
csv_file <- list.files(paste0(subfolder,"\\Results\\"), pattern = "_dailypresence.csv", #find the presence csv
full.names = TRUE) %>%
{ .[!grepl("interim", basename(.))] }
}
if (length(csv_file) == 0) next
df <- read_csv(csv_file) #read presence csv
df$deployment <- deployment
df<- df %>%
mutate(deployment = deployment,
station = str_extract(deployment, "^[^_]+")) %>%
mutate(detecdate = as_date(detecdate, format = "%m/%d/%Y")) %>%
relocate(station,deployment)
# Store the dataframe in the list
dfs[[length(dfs) + 1]] <- df
}
data.input <- bind_rows(dfs)
species.data <- data.input %>%
filter(presence == "D") %>%   # filters for definite presence
filter(year(detecdate)>=params$year_start& year(detecdate)<=params$year_end) %>%
filter(if (params$filterspecies) species %in% params$species else TRUE) %>%   # filters for species of %>% # filters for species of interest
select(!calltype) %>%
mutate(callcat = case_when(callcat == "NS"~"MO",
callcat == "SG"~"MO", .default =callcat)) %>%
filter(callcat %in% call.cats) %>%  #filters for wanted call category
distinct() %>%
mutate(spcallgroup_label = case_when((species== "Bm" & callcat == "IF")~"Blue whale (tonal calls)",
(species== "Bm" & callcat == "A")~"Blue whale (audible calls)",
(species== "Bp" & callcat == "IS")~"Fin whale (20Hz calls)",
(species== "Bb" & callcat == "FF")~"Sei whale (full frequency downsweep calls)",
(species== "Mn")                  ~"Humpback whale (all calls)",
(species== "Eg" & callcat == "UP")~"North Atlantic right whale (upcalls)",
(species== "Ba" & callcat == "P")~"Minke whale (pulse trains)")) %>%
mutate(spcallgroup = case_when(species=='Bm' & callcat=="IF" ~ 'BW_IF_all',
species=="Bm" & callcat=='A' ~ 'BW_A_all',
species=='Bp' & callcat=='IS' ~ 'FW_IS_D',
species=='Bb' & callcat=='FF' ~ 'SW_FF_all',
species=='Mn' ~ 'HB_all',
species=='Eg' & callcat=='UP'~ 'RW_UP_U',
species=="Ba"~ 'MW_all'))
## All the labelling bits and pieces ----
species.call.label <- unique(species.data$spcallgroup_label[species.data$species==params$species])
spcallgroup_labels = c("Blue whale (tonal calls)","Blue whale (audible calls)","Fin whale (20Hz calls)",
"Sei whale (full frequency downsweep calls)","Humpback whale (all calls)",
"North Atlantic right whale (upcalls)","Minke whale (pulse trains)")
spcallgroup_list <- c('BW_IF_all','BW_A_all',"FW_IS_D","SW_FF_all","HB_all", "RW_UP_U", "MW_all")
sp_label <-c("Blue whale (tonal calls)","Blue whale (audible calls)","Fin whale","Sei whale","Humpback whale", "North Atlantic right whale", "Minke whale")
names(spcallgroup_list) <-sp_label
cols <-c( "#1F78B4","#A6CEE3","#7570B3", "#F0E442", "#E7298A", "#D55E00", "#66A61E")
names(cols) <- spcallgroup_list
fig_height <- as.numeric(length(unique(species.data$station)))
